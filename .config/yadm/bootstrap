#!/bin/bash
dir="$(dirname "$0")"
. /etc/os-release
distro=ID
release=VERSION_ID
cd "$dir" || exit 1

if ((EUID == 0))
then if [ -s /etc/redhat-release ]
     then command dnf install --assumeyes python-virtualenv python-pip gcc-go golang-bin cargo
     fi
     . "$dir"/bootstrap.d/${!distro}/${!release}
fi

for pip in "${HOME:-~}"/.pyenv/bin/pip; do
    if [[ -f $pip ]]
    then
        "$pip" install --upgrade pip
        "$pip" install -r "$dir"/requirements.txt
        break
    fi
done

trap '${TMPDIR:+rm -rvf $TMPDIR}' EXIT
PREFIX=${HOME:-~}
TMPDIR="$(mktemp -d /run/user/$(id -u)/XXXXX.tmp)"
mkdir --parents ${PREFIX:-/tmp}/.config/waybar/
pushd $TMPDIR  || exit 1
git clone --depth 1 https://github.com/catppuccin/waybar
pushd waybar
cp --recursive themes/ assets/ ${PREFIX:-/tmp}/.config/waybar/
ls "$TMPDIR"

# command yadm alt
